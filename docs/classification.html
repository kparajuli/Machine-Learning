<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Machine-Learning - Classification: Unveiling Insights</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Machine-Learning</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./prob_and_randvar.html" rel="" target="">
 <span class="menu-text">Probability Theory and Random Variables</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./clustering.html" rel="" target="">
 <span class="menu-text">Clustering: Unraveling Patterns</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./regression.html" rel="" target="">
 <span class="menu-text">Regression: Linear and Non-Linear</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./classification.html" rel="" target="" aria-current="page">
 <span class="menu-text">Classification: Unveiling Insights</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./anomaly.html" rel="" target="">
 <span class="menu-text">Anomaly/Outlier Detection</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Classification: Unveiling Insights</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Machine learning, a dynamic field at the intersection of computer science and statistics, is empowered by diverse algorithms designed to make sense of data. One of the foundational tasks within machine learning is classification - a process that assigns predefined labels or categories to input data. In this blog post, we will embark on a journey to unravel the intricacies of classification in machine learning (using R), exploring its significance, techniques, and applications.</p>
<section id="understanding-classification" class="level4">
<h4 class="anchored" data-anchor-id="understanding-classification">Understanding Classification</h4>
<p>Classification is a supervised learning technique where the algorithm learns from labeled training data and predicts the labels of unseen or new data points. In essence, it is the process of mapping input data to predefined classes.</p>
</section>
<section id="importance-of-classification" class="level4">
<h4 class="anchored" data-anchor-id="importance-of-classification">Importance of Classification</h4>
<p>Classification plays a pivotal role in a myriad of applications in this day and age:</p>
<ol type="1">
<li><strong>Spam detection</strong>: Classifying emails as spam or not spam</li>
<li><strong>Medical Diagnosis</strong>: Identifying diseases based on patient data</li>
<li><strong>Credit Scoring</strong>: Assessing the creditworthiness of individuals</li>
<li><strong>Image Recognition</strong>: Recognizing objects or patterns in images</li>
<li><strong>Sentiment Analysis</strong>: Analyzing text to determine sentiment (positive, negative, neutral)</li>
</ol>
</section>
<section id="techniques-in-classification" class="level4">
<h4 class="anchored" data-anchor-id="techniques-in-classification">Techniques in Classification</h4>
<section id="logistic-regression" class="level5">
<h5 class="anchored" data-anchor-id="logistic-regression">Logistic Regression</h5>
<p>Despite the name, logistic regression is a classification algorithm used for binary classification problems. It models the probability of an instance belonging to a particular class.</p>
</section>
<section id="decision-trees" class="level5">
<h5 class="anchored" data-anchor-id="decision-trees">Decision Trees</h5>
<p>Decision trees are tree-like structures where each node represents a decision based on a feature. They recursively split the dataset to create a tree that predicts the class label.</p>
</section>
<section id="support-vector-machines-svm" class="level5">
<h5 class="anchored" data-anchor-id="support-vector-machines-svm">Support Vector Machines (SVM)</h5>
<p>SVM is a powerful algorithm for both binary and multiclass classification. It aims to find the hyperplane that best separates different classes in feature space.</p>
</section>
<section id="random-forest" class="level5">
<h5 class="anchored" data-anchor-id="random-forest">Random Forest</h5>
<p>Random Forest is an ensemble learning method that constructs multiple decision trees during training and outputs the class that is the mode of the classes (classification) or mean prediction (regression) of the individual trees.</p>
</section>
</section>
<section id="evaluating-classification-models" class="level4">
<h4 class="anchored" data-anchor-id="evaluating-classification-models">Evaluating Classification Models</h4>
<section id="confusion-matrix" class="level5">
<h5 class="anchored" data-anchor-id="confusion-matrix">Confusion Matrix</h5>
<p>A confusion matrix is a table that describes the performance of a classification model. It summarizes the number of true positive, true negative, false positive, and false negative predictions.</p>
</section>
<section id="accuracy-precision-recall-f1-score" class="level5">
<h5 class="anchored" data-anchor-id="accuracy-precision-recall-f1-score">Accuracy, Precision, Recall, F1 Score</h5>
<p>These metrics provide a more detailed assessment of a classification model’s performance:</p>
<ul>
<li><strong>Accuracy</strong>: Proportion of correctly classified instances.</li>
<li><strong>Precision</strong>: Proportion of true positive predictions among all positive predictions.</li>
<li><strong>Recall (Sensitivity)</strong>: Proportion of true positive predictions among all actual positive instances.</li>
<li><strong>F1 Score</strong>: A balance between precision and recall.</li>
</ul>
<p>In this blog, we will be using a `Wine Quality’ dataset to apply some classification techniques, mainly Logistic Regression and Decision Trees.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  fixed.acidity volatile.acidity citric.acid residual.sugar chlorides
1           7.4             0.70        0.00            1.9     0.076
2           7.8             0.88        0.00            2.6     0.098
3           7.8             0.76        0.04            2.3     0.092
4          11.2             0.28        0.56            1.9     0.075
5           7.4             0.70        0.00            1.9     0.076
6           7.4             0.66        0.00            1.8     0.075
  free.sulfur.dioxide total.sulfur.dioxide density   pH sulphates alcohol
1                  11                   34  0.9978 3.51      0.56     9.4
2                  25                   67  0.9968 3.20      0.68     9.8
3                  15                   54  0.9970 3.26      0.65     9.8
4                  17                   60  0.9980 3.16      0.58     9.8
5                  11                   34  0.9978 3.51      0.56     9.4
6                  13                   40  0.9978 3.51      0.56     9.4
  quality
1       5
2       5
3       5
4       6
5       5
6       5</code></pre>
</div>
</div>
<p>In this data set the first 11 are the objective variables that measure different chemical aspects of different wines. The 12th dimension <strong>quality</strong> is the output variable, the one we are trying to predict.</p>
<p>To make the classification simpler, we are going to put the quality column into categories. A quality score of 3 or 4 will be classified as <strong>Low</strong>, 5 or 6 as <strong>Medium</strong> and &amp; or 8 as <strong>High</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>wine<span class="sc">$</span>low <span class="ot">&lt;-</span> wine<span class="sc">$</span>quality <span class="sc">&lt;=</span> <span class="dv">4</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>wine<span class="sc">$</span>medium <span class="ot">&lt;-</span> wine<span class="sc">$</span>quality <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> wine<span class="sc">$</span>quality <span class="sc">==</span> <span class="dv">6</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>wine<span class="sc">$</span>high <span class="ot">&lt;-</span> wine<span class="sc">$</span>quality <span class="sc">&gt;=</span> <span class="dv">7</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  fixed.acidity volatile.acidity citric.acid residual.sugar chlorides
1           7.4             0.70        0.00            1.9     0.076
2           7.8             0.88        0.00            2.6     0.098
3           7.8             0.76        0.04            2.3     0.092
4          11.2             0.28        0.56            1.9     0.075
5           7.4             0.70        0.00            1.9     0.076
6           7.4             0.66        0.00            1.8     0.075
  free.sulfur.dioxide total.sulfur.dioxide density   pH sulphates alcohol
1                  11                   34  0.9978 3.51      0.56     9.4
2                  25                   67  0.9968 3.20      0.68     9.8
3                  15                   54  0.9970 3.26      0.65     9.8
4                  17                   60  0.9980 3.16      0.58     9.8
5                  11                   34  0.9978 3.51      0.56     9.4
6                  13                   40  0.9978 3.51      0.56     9.4
  quality   low medium  high
1       5 FALSE   TRUE FALSE
2       5 FALSE   TRUE FALSE
3       5 FALSE   TRUE FALSE
4       6 FALSE   TRUE FALSE
5       5 FALSE   TRUE FALSE
6       5 FALSE   TRUE FALSE</code></pre>
</div>
</div>
</section>
</section>
<section id="applying-logisitc-regression" class="level4">
<h4 class="anchored" data-anchor-id="applying-logisitc-regression">Applying Logisitc Regression</h4>
<p>For the classification techniques here we will use two approches/models - one using just the alcohol level and one with more than one variable.</p>
<p>For the first model, we will narrow out down to just being interested in <strong>High</strong> quality wines.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>log1_high <span class="ot">&lt;-</span> <span class="fu">glm</span> (high<span class="sc">~</span>alcohol, <span class="at">data=</span>wine, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">'logit'</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>log2_high <span class="ot">&lt;-</span> <span class="fu">glm</span>(high<span class="sc">~</span>alcohol <span class="sc">+</span> volatile.acidity <span class="sc">+</span> citric.acid <span class="sc">+</span> sulphates, <span class="at">data=</span>wine, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">'logit'</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log1_high)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = high ~ alcohol, family = binomial(link = "logit"), 
    data = wine)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -13.23466    0.84022  -15.75   &lt;2e-16 ***
alcohol       1.05057    0.07486   14.03   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1269.9  on 1598  degrees of freedom
Residual deviance: 1027.9  on 1597  degrees of freedom
AIC: 1031.9

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log2_high)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = high ~ alcohol + volatile.acidity + citric.acid + 
    sulphates, family = binomial(link = "logit"), data = wine)

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      -13.1586     1.1252 -11.694  &lt; 2e-16 ***
alcohol            1.0114     0.0814  12.424  &lt; 2e-16 ***
volatile.acidity  -3.5839     0.6854  -5.229 1.70e-07 ***
citric.acid        0.9378     0.5270   1.780   0.0751 .  
sulphates          2.4424     0.4488   5.442 5.27e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1269.92  on 1598  degrees of freedom
Residual deviance:  914.11  on 1594  degrees of freedom
AIC: 924.11

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>Looking at the AIC (Akaike information criterion), which gets lower as the model gets better, we can see that combining variables together prove to be better classifying model than just using the alcohol variable. Next, we will make some predictions and use some visualizations to assess the two models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>p_log1_high <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">predict</span>(log1_high))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>p_log2_high <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">predict</span>(log2_high))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>auc1 <span class="ot">&lt;-</span> <span class="fu">plot.roc</span>(wine<span class="sc">$</span>high, p_log1_high, <span class="at">main=</span><span class="st">""</span>, <span class="at">percent=</span><span class="cn">TRUE</span>, <span class="at">ci=</span><span class="cn">TRUE</span>, <span class="at">print.auc=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = FALSE, case = TRUE</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>auc1.se <span class="ot">&lt;-</span> <span class="fu">ci.se</span>(auc1, <span class="at">specificities=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">5</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(auc1.se,<span class="at">type=</span><span class="st">"shape"</span>, <span class="at">col=</span><span class="st">"grey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="classification_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>auc2 <span class="ot">&lt;-</span> <span class="fu">plot.roc</span>(wine<span class="sc">$</span>high, p_log2_high, <span class="at">main=</span><span class="st">""</span>, <span class="at">percent=</span><span class="cn">TRUE</span>, <span class="at">ci=</span><span class="cn">TRUE</span>, <span class="at">print.auc=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = FALSE, case = TRUE
Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>auc2.se <span class="ot">&lt;-</span> <span class="fu">ci.se</span>(auc2, <span class="at">specificities=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">5</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(auc2.se,<span class="at">type=</span><span class="st">"shape"</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="classification_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>These visualizations further support our claim that the second model with more variables is better (the higher the AUC the better the model is).</p>
</section>
<section id="applying-decision-trees" class="level4">
<h4 class="anchored" data-anchor-id="applying-decision-trees">Applying Decision Trees</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>dtree1 <span class="ot">&lt;-</span> <span class="fu">rpart</span>(high <span class="sc">~</span> alcohol <span class="sc">+</span> sulphates, <span class="at">data=</span>wine, <span class="at">method =</span> <span class="st">"class"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dtree1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rpart(formula = high ~ alcohol + sulphates, data = wine, method = "class")
  n= 1599 

          CP nsplit rel error    xerror       xstd
1 0.08294931      0 1.0000000 1.0000000 0.06311025
2 0.01000000      2 0.8341014 0.8341014 0.05838395

Variable importance
  alcohol sulphates 
       74        26 

Node number 1: 1599 observations,    complexity param=0.08294931
  predicted class=FALSE  expected loss=0.1357098  P(node) =1
    class counts:  1382   217
   probabilities: 0.864 0.136 
  left son=2 (1349 obs) right son=3 (250 obs)
  Primary splits:
      alcohol   &lt; 11.55 to the left,  improve=54.87599, (0 missing)
      sulphates &lt; 0.675 to the left,  improve=33.01760, (0 missing)

Node number 2: 1349 observations
  predicted class=FALSE  expected loss=0.07931801  P(node) =0.8436523
    class counts:  1242   107
   probabilities: 0.921 0.079 

Node number 3: 250 observations,    complexity param=0.08294931
  predicted class=FALSE  expected loss=0.44  P(node) =0.1563477
    class counts:   140   110
   probabilities: 0.560 0.440 
  left son=6 (136 obs) right son=7 (114 obs)
  Primary splits:
      sulphates &lt; 0.685 to the left,  improve=19.8989200, (0 missing)
      alcohol   &lt; 12.05 to the left,  improve= 0.5101698, (0 missing)
  Surrogate splits:
      alcohol &lt; 13.25 to the left,  agree=0.592, adj=0.105, (0 split)

Node number 6: 136 observations
  predicted class=FALSE  expected loss=0.2573529  P(node) =0.08505316
    class counts:   101    35
   probabilities: 0.743 0.257 

Node number 7: 114 observations
  predicted class=TRUE   expected loss=0.3421053  P(node) =0.07129456
    class counts:    39    75
   probabilities: 0.342 0.658 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(dtree1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="classification_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pred_dtree1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(dtree1, <span class="at">newdata=</span>wine, <span class="at">type=</span><span class="st">"class"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>dtree2 <span class="ot">&lt;-</span> <span class="fu">rpart</span>(high <span class="sc">~</span> alcohol <span class="sc">+</span> volatile.acidity <span class="sc">+</span> citric.acid <span class="sc">+</span> sulphates, <span class="at">data=</span>wine, <span class="at">method =</span> <span class="st">"class"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dtree2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rpart(formula = high ~ alcohol + volatile.acidity + citric.acid + 
    sulphates, data = wine, method = "class")
  n= 1599 

          CP nsplit rel error    xerror       xstd
1 0.08294931      0 1.0000000 1.0000000 0.06311025
2 0.01382488      2 0.8341014 0.9078341 0.06056520
3 0.01152074      8 0.7465438 0.9400922 0.06147779
4 0.01000000     11 0.7096774 0.9216590 0.06095929

Variable importance
         alcohol        sulphates volatile.acidity      citric.acid 
              51               20               16               14 

Node number 1: 1599 observations,    complexity param=0.08294931
  predicted class=FALSE  expected loss=0.1357098  P(node) =1
    class counts:  1382   217
   probabilities: 0.864 0.136 
  left son=2 (1349 obs) right son=3 (250 obs)
  Primary splits:
      alcohol          &lt; 11.55 to the left,  improve=54.87599, (0 missing)
      volatile.acidity &lt; 0.385 to the right, improve=35.03893, (0 missing)
      sulphates        &lt; 0.675 to the left,  improve=33.01760, (0 missing)
      citric.acid      &lt; 0.315 to the left,  improve=27.06204, (0 missing)
  Surrogate splits:
      volatile.acidity &lt; 0.14  to the right, agree=0.846, adj=0.012, (0 split)

Node number 2: 1349 observations,    complexity param=0.01382488
  predicted class=FALSE  expected loss=0.07931801  P(node) =0.8436523
    class counts:  1242   107
   probabilities: 0.921 0.079 
  left son=4 (1111 obs) right son=5 (238 obs)
  Primary splits:
      volatile.acidity &lt; 0.375 to the right, improve=17.25464, (0 missing)
      alcohol          &lt; 10.45 to the left,  improve=12.96381, (0 missing)
      sulphates        &lt; 0.675 to the left,  improve=12.53088, (0 missing)
      citric.acid      &lt; 0.295 to the left,  improve= 9.43151, (0 missing)
  Surrogate splits:
      citric.acid &lt; 0.71  to the left,  agree=0.824, adj=0.004, (0 split)

Node number 3: 250 observations,    complexity param=0.08294931
  predicted class=FALSE  expected loss=0.44  P(node) =0.1563477
    class counts:   140   110
   probabilities: 0.560 0.440 
  left son=6 (136 obs) right son=7 (114 obs)
  Primary splits:
      sulphates        &lt; 0.685 to the left,  improve=19.8989200, (0 missing)
      citric.acid      &lt; 0.315 to the left,  improve= 9.1723060, (0 missing)
      volatile.acidity &lt; 0.425 to the right, improve= 6.7370480, (0 missing)
      alcohol          &lt; 12.05 to the left,  improve= 0.5101698, (0 missing)
  Surrogate splits:
      citric.acid      &lt; 0.305 to the left,  agree=0.628, adj=0.184, (0 split)
      volatile.acidity &lt; 0.345 to the right, agree=0.596, adj=0.114, (0 split)
      alcohol          &lt; 13.25 to the left,  agree=0.592, adj=0.105, (0 split)

Node number 4: 1111 observations
  predicted class=FALSE  expected loss=0.04230423  P(node) =0.6948093
    class counts:  1064    47
   probabilities: 0.958 0.042 

Node number 5: 238 observations,    complexity param=0.01382488
  predicted class=FALSE  expected loss=0.2521008  P(node) =0.148843
    class counts:   178    60
   probabilities: 0.748 0.252 
  left son=10 (120 obs) right son=11 (118 obs)
  Primary splits:
      alcohol          &lt; 10.45 to the left,  improve=12.459480, (0 missing)
      sulphates        &lt; 0.635 to the left,  improve= 7.099497, (0 missing)
      citric.acid      &lt; 0.285 to the left,  improve= 2.817234, (0 missing)
      volatile.acidity &lt; 0.205 to the left,  improve= 1.465961, (0 missing)
  Surrogate splits:
      sulphates        &lt; 0.675 to the left,  agree=0.601, adj=0.195, (0 split)
      citric.acid      &lt; 0.285 to the left,  agree=0.584, adj=0.161, (0 split)
      volatile.acidity &lt; 0.345 to the left,  agree=0.542, adj=0.076, (0 split)

Node number 6: 136 observations,    complexity param=0.01152074
  predicted class=FALSE  expected loss=0.2573529  P(node) =0.08505316
    class counts:   101    35
   probabilities: 0.743 0.257 
  left son=12 (95 obs) right son=13 (41 obs)
  Primary splits:
      citric.acid      &lt; 0.445 to the left,  improve=4.984524, (0 missing)
      volatile.acidity &lt; 0.385 to the right, improve=3.217852, (0 missing)
      sulphates        &lt; 0.615 to the left,  improve=2.845143, (0 missing)
      alcohol          &lt; 12.45 to the right, improve=1.220143, (0 missing)
  Surrogate splits:
      volatile.acidity &lt; 0.305 to the right, agree=0.728, adj=0.098, (0 split)
      sulphates        &lt; 0.635 to the left,  agree=0.728, adj=0.098, (0 split)
      alcohol          &lt; 13.15 to the left,  agree=0.706, adj=0.024, (0 split)

Node number 7: 114 observations
  predicted class=TRUE   expected loss=0.3421053  P(node) =0.07129456
    class counts:    39    75
   probabilities: 0.342 0.658 

Node number 10: 120 observations
  predicted class=FALSE  expected loss=0.09166667  P(node) =0.0750469
    class counts:   109    11
   probabilities: 0.908 0.092 

Node number 11: 118 observations,    complexity param=0.01382488
  predicted class=FALSE  expected loss=0.4152542  P(node) =0.07379612
    class counts:    69    49
   probabilities: 0.585 0.415 
  left son=22 (58 obs) right son=23 (60 obs)
  Primary splits:
      sulphates        &lt; 0.735 to the left,  improve=4.4326710, (0 missing)
      citric.acid      &lt; 0.335 to the left,  improve=0.8028625, (0 missing)
      alcohol          &lt; 10.75 to the left,  improve=0.6463546, (0 missing)
      volatile.acidity &lt; 0.235 to the left,  improve=0.4687211, (0 missing)
  Surrogate splits:
      alcohol          &lt; 11.05 to the right, agree=0.619, adj=0.224, (0 split)
      citric.acid      &lt; 0.425 to the left,  agree=0.610, adj=0.207, (0 split)
      volatile.acidity &lt; 0.335 to the right, agree=0.585, adj=0.155, (0 split)

Node number 12: 95 observations
  predicted class=FALSE  expected loss=0.1684211  P(node) =0.05941213
    class counts:    79    16
   probabilities: 0.832 0.168 

Node number 13: 41 observations,    complexity param=0.01152074
  predicted class=FALSE  expected loss=0.4634146  P(node) =0.02564103
    class counts:    22    19
   probabilities: 0.537 0.463 
  left son=26 (12 obs) right son=27 (29 obs)
  Primary splits:
      alcohol          &lt; 12.45 to the right, improve=2.987945, (0 missing)
      citric.acid      &lt; 0.55  to the right, improve=1.664754, (0 missing)
      sulphates        &lt; 0.58  to the left,  improve=1.195244, (0 missing)
      volatile.acidity &lt; 0.275 to the left,  improve=0.533101, (0 missing)
  Surrogate splits:
      citric.acid &lt; 0.685 to the right, agree=0.756, adj=0.167, (0 split)
      sulphates   &lt; 0.655 to the right, agree=0.732, adj=0.083, (0 split)

Node number 22: 58 observations
  predicted class=FALSE  expected loss=0.2758621  P(node) =0.03627267
    class counts:    42    16
   probabilities: 0.724 0.276 

Node number 23: 60 observations,    complexity param=0.01382488
  predicted class=TRUE   expected loss=0.45  P(node) =0.03752345
    class counts:    27    33
   probabilities: 0.450 0.550 
  left son=46 (12 obs) right son=47 (48 obs)
  Primary splits:
      citric.acid      &lt; 0.345 to the left,  improve=2.7000000, (0 missing)
      sulphates        &lt; 0.775 to the right, improve=1.5000000, (0 missing)
      volatile.acidity &lt; 0.335 to the right, improve=0.5730159, (0 missing)
      alcohol          &lt; 10.85 to the right, improve=0.3080586, (0 missing)

Node number 26: 12 observations
  predicted class=FALSE  expected loss=0.1666667  P(node) =0.00750469
    class counts:    10     2
   probabilities: 0.833 0.167 

Node number 27: 29 observations,    complexity param=0.01152074
  predicted class=TRUE   expected loss=0.4137931  P(node) =0.01813634
    class counts:    12    17
   probabilities: 0.414 0.586 
  left son=54 (19 obs) right son=55 (10 obs)
  Primary splits:
      alcohol          &lt; 12.05 to the left,  improve=3.005808, (0 missing)
      sulphates        &lt; 0.575 to the left,  improve=2.617985, (0 missing)
      citric.acid      &lt; 0.55  to the right, improve=1.755834, (0 missing)
      volatile.acidity &lt; 0.37  to the left,  improve=1.098377, (0 missing)
  Surrogate splits:
      volatile.acidity &lt; 0.315 to the right, agree=0.724, adj=0.2, (0 split)
      citric.acid      &lt; 0.485 to the right, agree=0.690, adj=0.1, (0 split)

Node number 46: 12 observations
  predicted class=FALSE  expected loss=0.25  P(node) =0.00750469
    class counts:     9     3
   probabilities: 0.750 0.250 

Node number 47: 48 observations,    complexity param=0.01382488
  predicted class=TRUE   expected loss=0.375  P(node) =0.03001876
    class counts:    18    30
   probabilities: 0.375 0.625 
  left son=94 (26 obs) right son=95 (22 obs)
  Primary splits:
      citric.acid      &lt; 0.475 to the right, improve=3.0314690, (0 missing)
      sulphates        &lt; 0.795 to the left,  improve=0.7500000, (0 missing)
      volatile.acidity &lt; 0.355 to the left,  improve=0.5170940, (0 missing)
      alcohol          &lt; 11.05 to the right, improve=0.3947368, (0 missing)
  Surrogate splits:
      sulphates        &lt; 0.795 to the left,  agree=0.750, adj=0.455, (0 split)
      alcohol          &lt; 10.95 to the left,  agree=0.667, adj=0.273, (0 split)
      volatile.acidity &lt; 0.255 to the right, agree=0.667, adj=0.273, (0 split)

Node number 54: 19 observations
  predicted class=FALSE  expected loss=0.4210526  P(node) =0.01188243
    class counts:    11     8
   probabilities: 0.579 0.421 

Node number 55: 10 observations
  predicted class=TRUE   expected loss=0.1  P(node) =0.006253909
    class counts:     1     9
   probabilities: 0.100 0.900 

Node number 94: 26 observations,    complexity param=0.01382488
  predicted class=FALSE  expected loss=0.4615385  P(node) =0.01626016
    class counts:    14    12
   probabilities: 0.538 0.462 
  left son=188 (13 obs) right son=189 (13 obs)
  Primary splits:
      citric.acid      &lt; 0.525 to the left,  improve=2.7692310, (0 missing)
      sulphates        &lt; 0.775 to the right, improve=2.7531420, (0 missing)
      alcohol          &lt; 10.95 to the right, improve=1.5766720, (0 missing)
      volatile.acidity &lt; 0.315 to the right, improve=0.7326007, (0 missing)
  Surrogate splits:
      sulphates        &lt; 0.845 to the right, agree=0.692, adj=0.385, (0 split)
      volatile.acidity &lt; 0.295 to the left,  agree=0.654, adj=0.308, (0 split)
      alcohol          &lt; 10.85 to the right, agree=0.615, adj=0.231, (0 split)

Node number 95: 22 observations
  predicted class=TRUE   expected loss=0.1818182  P(node) =0.0137586
    class counts:     4    18
   probabilities: 0.182 0.818 

Node number 188: 13 observations
  predicted class=FALSE  expected loss=0.2307692  P(node) =0.008130081
    class counts:    10     3
   probabilities: 0.769 0.231 

Node number 189: 13 observations
  predicted class=TRUE   expected loss=0.3076923  P(node) =0.008130081
    class counts:     4     9
   probabilities: 0.308 0.692 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(dtree2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="classification_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pred_dtree2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(dtree2, <span class="at">newdata=</span>wine, <span class="at">type=</span><span class="st">"class"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will use confusion matrices to evaluate the two decision trees.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wine<span class="sc">$</span>high, pred_dtree1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       pred_dtree1
        FALSE TRUE
  FALSE  1343   39
  TRUE    142   75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wine<span class="sc">$</span>high, pred_dtree2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       pred_dtree2
        FALSE TRUE
  FALSE  1334   48
  TRUE    106  111</code></pre>
</div>
</div>
<p>Next, we will calculate the accuracy using <span class="math display">\[Accuracy = \frac{True Positive + True Negative}  {(True Positive + True Negative + FalsePositve + FalseNegative)} \]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>accuracy1 <span class="ot">&lt;-</span> (<span class="dv">1343</span> <span class="sc">+</span> <span class="dv">75</span>) <span class="sc">/</span> (<span class="dv">1343</span> <span class="sc">+</span> <span class="dv">75</span> <span class="sc">+</span> <span class="dv">39</span> <span class="sc">+</span> <span class="dv">142</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(accuracy1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8868043</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>accuracy2 <span class="ot">&lt;-</span> (<span class="dv">1334</span> <span class="sc">+</span> <span class="dv">111</span>) <span class="sc">/</span> (<span class="dv">1334</span> <span class="sc">+</span> <span class="dv">111</span> <span class="sc">+</span> <span class="dv">48</span> <span class="sc">+</span> <span class="dv">106</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(accuracy2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9036898</code></pre>
</div>
</div>
<p>The second model with more of the variables has a better accuracy of <strong>90.36%</strong>.</p>
<p>In conclusion, classification in machine learning is a fundamental task with wide-ranging applications. By employing various algorithms and evaluating their performance, data scientists and machine learning practitioners can build robust models capable of making accurate predictions.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>